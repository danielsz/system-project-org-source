<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2017-02-12 Sun 03:38 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>system homepage website</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Daniel Szmulewicz">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="css/typography.css" rel="stylesheet" type="text/css" />
<link href="css/grid-named-lines.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Roboto+Condensed|Source+Serif+Pro|Inconsolata" rel="stylesheet">
<script src="js/main.js" type="text/javascript"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge00a123">Installation</a></li>
<li><a href="#org2503010">Quickstart</a></li>
<li><a href="#org8482b0a">Introduction</a></li>
<li><a href="#org8976be3">Duct</a></li>
<li><a href="#org98d677f">Live reloading</a></li>
<li><a href="#orga70d882">Components</a></li>
<li><a href="#org9089911">Examples</a></li>
<li><a href="#org3bd5a73">API</a></li>
</ul>
</div>
</nav>

<article id="outline-container-orge00a123" class="outline-2">
<h2 id="orge00a123">Installation</h2>
<div class="outline-text-2" id="text-orge00a123">
<p>
Add the following to your projectâ€™s dependencies.
</p>
<pre class="example">
lala
</pre>
</div>
</article>
<article id="outline-container-org2503010" class="outline-2">
<h2 id="org2503010">Quickstart</h2>
<div class="outline-text-2" id="text-org2503010">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #a020f0;">ns</span> <span style="color: #228b22;">user</span>
  <span style="color: #7388d6;">(</span><span style="color: #008b8b;">:require</span> <span style="color: #909183;">[</span><span style="color: #228b22;">system.repl</span> <span style="color: #008b8b;">:refer</span> <span style="color: #709870;">[</span>system set-init! reset<span style="color: #709870;">]</span><span style="color: #909183;">]</span>
            <span style="color: #909183;">[</span><span style="color: #228b22;">my-app.systems</span> <span style="color: #008b8b;">:refer</span> <span style="color: #709870;">[</span>dev-system<span style="color: #709870;">]</span><span style="color: #909183;">]</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>set-init! #'dev-system<span style="color: #707183;">)</span>
</pre>
</div>
</div>
</article>
<article id="outline-container-org8482b0a" class="outline-2">
<h2 id="org8482b0a">Introduction</h2>
<div class="outline-text-2" id="text-org8482b0a">
<p>
<b>system</b> owes to <a href="https://github.com/stuartsierra/component">component</a> both in spirit and in name. The component library helps implement the reloaded pattern as championed by Stuart Sierra. <b>system</b> is built on top of it, offering a set of readymade components.
</p>
</div>
</article>
<article id="outline-container-org8976be3" class="outline-2">
<h2 id="org8976be3">Duct</h2>
<div class="outline-text-2" id="text-org8976be3">
<p>
The Duct components, an idea that originated with James Reeves, are an
abstraction on top of the Ring architecture. It revolves around a
handler, endpoints and middleware. Compojure gave us means to route
http requests, Duct builds on that work and allows us to group routes
by purpose, exposing them to the dependencies they need.
</p>

<p>
The endpoints are in fact closures on top of routes with the
dependencies available in lexical scope. The middleware
components optionally receive dependencies as argument. <sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>
</p>
</div>
</article>
<article id="outline-container-org98d677f" class="outline-2">
<h2 id="org98d677f">Live reloading</h2>
<div class="outline-text-2" id="text-org98d677f">
<p>
<code>System</code> and <code>Boot</code> are a match made in heaven. Some of the properties that boot-system brings to your workflow are:
</p>

<ul class="org-ul">
<li>Manual and automatic mode, ie. either you manipulate the system in the REPL, or you configure it to react to editing changes.</li>
<li>Restartable system. What warrants a system restart is user-configurable. File-based granularity.</li>
<li>Changes that do not require a restart are available in the running system instantly (via namespace reloading).</li>
<li>Full <i>Lisp-style</i> interactive programming via the REPL and hot-reloading in the browser.</li>
</ul>

<p>
The <code>system</code> task is invoked like any <code>boot</code> task.
</p>
<div class="org-src-container">
<pre class="src src-shell">$ boot system -h
</pre>
</div>

<p>
Which outputs, for example:
</p>

<div class="org-src-container">
<pre class="src src-shell">-h, --help         Print this help info.
-s, --sys SYS      Set the system var to SYS.
-a, --auto         Manages the lifecycle of the application automatically.
-f, --files FILES  Will reset the system if a filename<span style="color: #a020f0;"> in</span> the supplied vector changes.
-r, --regexes      Treat --files as regexes, not file names. Only one of regexes|paths is allowed.
-p, --paths        Treat --files as classpath paths, not file names. Only one of regexes|paths is allowed.
</pre>
</div>

<p>
When <code>auto</code> is set to true, reloading of namespaces and restarts are being managed automatically.
</p>

<p>
If you set <code>auto</code> to false, you indicate that you want to handle restarts manually at the REPL, with <code>(system.repl/reset)</code>. Please note that SYS will be initialized and started for you at first run. 
</p>

<p>
If you donâ€™t supply a SYS argument, the system task will act as a <code>tools.namespace</code> wrapper. Each time you save your file, affected namespaces are reloaded in dependency order (after being unloaded in reverse order). This is handy for projects that do not use <code>Component</code>, like this <a href="https://github.com/danielsz/no-restarts">example</a> project. 
</p>
</div>

<div id="outline-container-orgc29a0ba" class="outline-4">
<h4 id="orgc29a0ba">Code reload vs system restart</h4>
<div class="outline-text-4" id="text-orgc29a0ba">
<p>
In traditional Lisp systems, users can redefine arbitrary, discrete units of code. Clojure, as a Lisp, is no exception. However, as a hosted language with many advanced dynamic features, code reloading has many <a href="https://github.com/clojure/tools.namespace#reloading-code-motivation">pitfalls</a>. <code>tools.namespace</code> fixes many of them, but ultimately, reloaded code will not agree with runtime state, and the system will need a full restart. This is  where <code>component</code> fits in. (Note that both libraries were authored by Stuart Sierra).
</p>

<p>
It is important to understand that code reloading and system restarts are orthogonalâ€”both are desirable properties in a programming environment. A full restart is a blunt tool. No need to restart the database just because a helper function was modified.
</p>

<p>
We <b>donâ€™t want</b> to restart the system with <b>every</b> code change. Ideally, we want to only reload the code that has changed, and occasionally restart (when necessary).
</p>

<p>
<code>boot-system</code> gives you finegrained tuning over system restarts vs code reload. Each time you change a file, <code>boot-system</code> will reload your code. Conversely, filenames that have been designated in the <code>files</code> option will trigger a full restart. Typically, the files vector will be small, as most modifications do not warrant a full restart. An example of when you would want a full restart is when you modify a Var that is used in a thread (that of a web server, for example). This is explained in detail in the <a href="http://danielsz.github.io/2016/05/06/Ghosts-in-the-machine">Ghosts in the machine</a> blog post. 
Check the options with <code>boot system -h</code>. 
</p>

<p>
In summary, when you instruct <code>boot-system</code> to manage your application lifecycle (with the <code>auto</code> option), either one of those two things will happen after you change a source file:
</p>
<ul class="org-ul">
<li><code>refresh</code> will first unload all affected namespaces (to remove old definitions) before reloading them in dependency order.</li>
<li><code>reset</code> will restart the system if that file was defined in the <code>files</code> vector.</li>
</ul>
</div>
</div>

<div id="outline-container-org4b682f2" class="outline-4">
<h4 id="org4b682f2">The Holy Grail</h4>
<div class="outline-text-4" id="text-org4b682f2">
<p>
With <code>system</code>, you can enjoy a true Lisp environment where code is always live (<b>live coding</b>). A <a href="https://github.com/danielsz/holygrail">tutorial</a> is available in a separate repository.
</p>
</div>
</div>

<div id="outline-container-org56163f7" class="outline-4">
<h4 id="org56163f7">Leiningen</h4>
<div class="outline-text-4" id="text-org56163f7">
<p>
If you are using Leiningen, we recommend <a href="https://github.com/bhauman/lein-figwheel">Figwheel</a> to address browser-side hot-reloading concerns.
</p>
</div>
</div>
</article>

<article id="outline-container-orga70d882" class="outline-2">
<h2 id="orga70d882">Components</h2>
<div class="outline-text-2" id="text-orga70d882">
<p>
The following components are available
</p>
<ul class="org-ul">
<li><a href="https://github.com/ring-clojure/ring">Jetty</a> (HTTP server)</li>
<li><a href="http://http-kit.org/">HTTP kit</a> (Async HTTP server)</li>
<li><a href="https://github.com/ztellman/aleph">aleph</a> (Async HTTP server)</li>
<li><a href="http://immutant.org/">Immutant Web</a> (Web component in application server suite)</li>
<li><a href="http://www.datomic.com/">Datomic</a> (Immutable database)</li>
<li><a href="http://docs.caudate.me/adi/">Adi</a> (Datomic interface)</li>
<li><a href="http://www.h2database.com/">H2</a> (H2 relational database)</li>
<li><a href="http://www.postgresql.org">PostgreSQL</a> (SQL Database)</li>
<li><a href="http://clojuremongodb.info/">Monger</a> (MongoDB client)</li>
<li><a href="http://clojureneo4j.info/">Neo4j</a> (Graph database)</li>
<li><a href="http://clojurequartz.info/">Quartzite</a> (Quartz Scheduler)</li>
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html">ScheduledExecutorService</a> (Java scheduler)</li>
<li><a href="https://github.com/ptaoussanis/sente">Sente</a> (Websockets/Ajax communications library)</li>
<li><a href="https://github.com/clojure/tools.nrepl">nREPL</a> (Clojure network REPL )</li>
<li><a href="https://github.com/clojure-emacs/cider-nrepl">Cider nREPL</a> (A collection of nREPL middleware designed to enhance CIDER)</li>
<li><a href="http://clojurerabbitmq.info/">Langohr</a> (RabbitMQ client)</li>
<li><a href="https://github.com/danielsz/etsy-clojure-api">Etsy</a> (Etsy client)</li>
<li><a href="http://docs.caudate.me/hara/#haraiowatch">hara.io.watch</a> (File watcher)</li>
<li><a href="http://docs.caudate.me/hara/hara-io-scheduler.html">hara.io.scheduler</a> (Cron-like scheduler)</li>
<li><a href="https://www.elastic.co/">Elasticsearch</a> (Elasticsearch full-text search engine)</li>
<li><a href="https://github.com/weavejester/duct">Duct-style</a> components for Ring applications</li>
<li><a href="https://github.com/tomekw/hikari-cp">Hikari CP</a> (JDBC connection pool)</li>
<li><a href="https://github.com/ptaoussanis/carmine">Carmine</a> (Redis PubSub)</li>
<li><a href="https://github.com/replikativ/konserve">Konserve</a> (Document store protocol)</li>
</ul>
</div>
</article>
<article id="outline-container-org9089911" class="outline-2">
<h2 id="org9089911">Examples</h2>
<div class="outline-text-2" id="text-org9089911">
<p>
Example projects are available under the <a href="https://github.com/danielsz/system/tree/master/examples">examples</a> folder.
</p>
</div>

<div id="outline-container-orgca59b35" class="outline-3">
<h3 id="orgca59b35">Get-started projects</h3>
<div class="outline-text-3" id="text-orgca59b35">
<p>
Two minimal projects that will help you get started. Both the <a href="https://github.com/danielsz/system/tree/master/examples/leiningen">Leiningen</a> and <a href="https://github.com/danielsz/system/tree/master/examples/boot">Boot</a> toolchain are covered.
</p>
</div>
</div>

<div id="outline-container-org88ef682" class="outline-3">
<h3 id="org88ef682">Real-world web service</h3>
<div class="outline-text-3" id="text-org88ef682">
<p>
A web service written multiple times using different styles.
</p>

<ul class="org-ul">
<li>System map is accessed directly. <a href="https://github.com/danielsz/system-advanced-example">https://github.com/danielsz/system-advanced-example</a></li>
<li>Dependency injection, Duct abstractions and other known techniques. <a href="https://github.com/danielsz/system-dependency-injection">https://github.com/danielsz/system-dependency-injection</a></li>
</ul>
</div>
</div>

<div id="outline-container-org1916475" class="outline-3">
<h3 id="org1916475">Websockets</h3>
<div class="outline-text-3" id="text-org1916475">
<p>
A web application with client-side UI. Demonstrates login procedure with Sente (a realtime web comms library).  
</p>

<ul class="org-ul">
<li><a href="https://github.com/danielsz/system-websockets">https://github.com/danielsz/system-websockets</a></li>
</ul>
</div>
</div>
</article>

<article id="outline-container-org3bd5a73" class="outline-2">
<h2 id="org3bd5a73">API</h2>
</article>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
At this point, this is true only for systemâ€™s
implementation of Duct.
</p></div></div>


</div>
</div></div>
</body>
</html>
